<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wangxinenpu.springbootdemo.dao.mapper.selfmachine.SiteAreaMapper">

    <resultMap id="siteAreaTreeVO" type="com.wangxinenpu.springbootdemo.dataobject.vo.SiteArea.SiteAreaTreeVO">
        <result property="id" column="id" />
        <result property="parentId" column="parent_id" />
        <result property="name" column="name" />
        <result property="bussType" column="buss_type" />
        <collection property="children" column="id"
                    ofType="com.wangxinenpu.springbootdemo.dataobject.vo.SiteArea.SiteAreaTreeVO"
                    select="selectNode"/>
    </resultMap>


    <resultMap id="siteAreaTreeVOList" type="com.wangxinenpu.springbootdemo.dataobject.vo.SiteArea.SiteAreaTreeVORequest">
        <result property="value" column="id" />
        <result property="parentId" column="parent_id" />
        <result property="label" column="name" />
        <result property="bussType" column="buss_type" />
    </resultMap>

    <select id="getSiteAreaTree" resultMap="siteAreaTreeVO">
        select * from site_area
        <where>
            parent_id is null
            and buss_type = #{bussType}
        </where>
    </select>

    <select id="selectNode"  resultMap="siteAreaTreeVO">
        select * from site_area
        <where>
            parent_id=#{id}
        </where>
    </select>


    <select id="getSiteAreaTreeParentId" resultMap="siteAreaTreeVOList">
        select * from site_area
        <where>
             buss_type = #{bussType}
        </where>
    </select>

    <select id="selectNodeParentId"  resultMap="siteAreaTreeVOList">
        select * from site_area
        <where>
            parent_id=#{id}
        </where>
    </select>

    <!--<insert id="insert" parameterType="com.insigma.facade.po.SiteArea">-->
    <!--INSERT INTO site_area ( -->
    <!--parent_id,name,buss_type			-->
    <!--) VALUES (-->
    <!--#{parentId},#{name},#{bussType}		-->
    <!--)   -->
    <!--<selectKey resultType="Integer" keyProperty="id">    -->
    <!--SELECT LAST_INSERT_ID()     -->
    <!--</selectKey> -->
    <!--</insert>-->
    <!---->
    <!--<update id="update" parameterType="com.insigma.facade.po.SiteArea" >-->
    <!--UPDATE-->
    <!--site_area-->
    <!--SET-->
    <!--            <if test="id!=null"> id = #{id} </if>
            <if test="parentId!=null">, parent_id = #{parentId} </if>
            <if test="name!=null">, name = #{name} </if>
            <if test="bussType!=null">, buss_type = #{bussType} </if>
-->
    <!--<where>-->
    <!--id = #{id}-->
    <!--</where>-->
    <!--</update>-->
    <!---->
    <!---->
    <!--<select id="getByKey" resultMap="BASE-RESULT">-->
    <!--SELECT * FROM-->
    <!--site_area-->
    <!--<where>-->
    <!--id = #{key}-->
    <!--</where>-->
    <!--</select>-->
    <!---->
    <!--<delete id="deleteByKey">-->
    <!--DELETE FROM-->
    <!--site_area-->
    <!--<where>-->
    <!--id = #{key}-->
    <!--</where>-->
    <!--</delete>-->
    <!---->
    <!--<select id="findEntitys" parameterType="map" resultMap="BASE-RESULT">-->
    <!--SELECT * FROM-->
    <!--site_area-->
    <!--<where>-->
    <!--<include refid="compareParamColumns" />-->
    <!--</where>-->
    <!--<if test="param.orderByStr!=null">-->
    <!--order by ${param.orderByStr}-->
    <!--</if>-->
    <!--<if test="param.start!=null and param.pageNum!=null">LIMIT #{param.start},#{param.pageNum}</if>-->
    <!--</select>-->


    <!--<select id="getEntitysCount" parameterType="map" resultType="int">-->
    <!--SELECT count(*) FROM-->
    <!--site_area-->
    <!--<where>-->
    <!--<include refid="compareParamColumns" />-->
    <!--</where>-->
    <!--</select>-->
    <!---->
    <!--<sql id="compareParamColumns">-->
    <!--1-->
    <!--        <if test="param.id!=null">
            AND  id = #{param.id}
        </if>
        <if test="param.parentId!=null">
            AND  parent_id = #{param.parentId}
        </if>
        <if test="param.name!=null">
            AND  name = #{param.name}
        </if>
        <if test="param.bussType!=null">
            AND  buss_type = #{param.bussType}
        </if>
-->
    <!--</sql>-->

</mapper>
